% emu-luatexbase.sty v 0.01 2015/07/14
% minimal luatexbase emulation, for testing with
% current luaotfload package
%
% Prevent luatex/luatexbase loading when it is referenced
\expandafter\def\csname luatexbase@sty@endinput\endcsname{}
\expandafter\def\csname ver@luatexbase.sty\endcsname{}
\expandafter\def\csname ver@luatexbase-modutils.sty\endcsname{}
\expandafter\def\csname ver@luatexbase-mcb.sty\endcsname{}
\expandafter\def\csname ver@luatexbase-attr.sty\endcsname{}
\expandafter\def\csname ver@luatex.sty\endcsname{}
%
% Simple require wrapper so that luaotfload does get loaded.
\def\RequireLuaModule#1{\directlua{require("#1")}}


% resolve name clashes...
\let\newluatexattribute\newattribute


\directlua{
% probably this shouldn't be allowed on primitive callbacks
% but this version allows otfload to run.
function luatexbase.reset_callback(a)
luatexbase.disable_callback(a)
end
%
% fontspec uses a latex-package catcode table
% this is called catcodetable@atletter in ltluatex.
% We also need to emulate the catcodetables table.
luatexbase.catcodetables={}
luatexbase.catcodetables['latex-package'] =
      luatexbase.registernumber("catcodetable@atletter")
}

